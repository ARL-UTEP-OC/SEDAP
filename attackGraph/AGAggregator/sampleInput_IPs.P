/*
Topology
									 (10.0.0.4)  (10.0.0.5)  (10.0.0.6)
ftpClientHost -- subnet1 -- router1 -- 'router2/32' -- router3 -- ftpServer
 (10.0.0.1)               (10.0.0.3)      |
                                          |
                                       subnet2  
                                          |
                                          |
                                       attacker  (10.0.0.7)

In this scenario, the attacker takes advantage of the fact
that ftp is cleartext and conducts route hijack attack thanks to 
a misconfigured routing protocol
*/

attackerLocated('router2/32').
attackGoal(execCode(ftpServerHost,userLevel)).

hacl(ftpClientHost, router1, _allProtocols , _allPorts).
hacl(router1, 'router2/32', _allProtocols , _allPorts).
hacl('router2/32', router3, _allProtocols , _allPorts).
hacl(router3, ftpServerHost, tcp , 21).

gateway(router1). 
gateway('router2/32').
gateway(router3).

/* client */
clientProgram(ftpClientHost,ftpClient_app).
networkServiceInfo(ftpClientHost, nrlolsr, olsr , _NA_layer3 , _NA_layer3). 
vulExists(ftpClientHost, nrlolsrVul, nrlolsr, remoteExploit, nrlolsrHijack).

/* routers */
networkServiceInfo(router1 , nrlolsr, olsr , _NA_layer3 , _NA_layer3). 
networkServiceInfo('router2/32' , nrlolsr, olsr , _NA_layer3 , _NA_layer3). 
networkServiceInfo(router3 , nrlolsr, olsr , _NA_layer3 , _NA_layer3). 

/* ftp server */
networkServiceInfo(ftpServerHost , ftpd, tcp , 21, userLevel). 
hasAccount(victimUser, ftpServerHost, userLevel).
networkServiceInfo(ftpServerHost, nrlolsr, olsr , _NA_layer3 , _NA_layer3). 
